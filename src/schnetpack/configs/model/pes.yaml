defaults:
  - representation: schnet

_target_: schnetpack.model.PESModel

optimizer_cls: torch.optim.Adam
optimizer_args:
  lr: ${lr}

scheduler_cls: schnetpack.train.ReduceLROnPlateau
scheduler_monitor: val_loss
scheduler_args:
  mode: min
  factor: 0.5
  patience: 50
  min_lr: 1e-6
  smoothing_factor: 0.8

output:
  _target_: schnetpack.atomistic.Atomwise
  n_in: ${model.representation.n_atom_basis}
  aggregation_mode: sum

energy_property: energy
energy_loss_fn:
  _target_: pytorch_lightning.metrics.MeanSquaredError
energy_weight: 0.05
energy_metrics:
  mae:
    _target_: pytorch_lightning.metrics.MeanAbsoluteError
  mse:
    _target_: pytorch_lightning.metrics.MeanSquaredError

forces_property: forces
forces_loss_fn:
  _target_: pytorch_lightning.metrics.MeanSquaredError
forces_weight: 0.95
forces_metrics:
  mae:
    _target_: pytorch_lightning.metrics.MeanAbsoluteError
  mse:
    _target_: pytorch_lightning.metrics.MeanSquaredError

postprocess: null

